# 实验结果

| 训练数据 | dataset | 模型 | NDCG@20 | NDCG@40 | NDCG@80 | Negative sampling | RMSE   | 训练时间  | best index |
| :----:| :---: | :----: | :----:| :----:| :----:| ------| ------| ------ | ------|
| Tmall |  | IMC-GAE | 0.00046 | 0.00082 | 0.0016  |        0X         | 0.7091 | 2021.4.7  | 410 |
| Tmall |  | IMC-GAE | 0.0310  | 0.0370  | 0.0452  |        1X         |        | 2021.4.13 |  |
| Tmall |  | IMC-GAE | 0.0335 | 0.0387 | 0.0487 |        2X         |        | 2021.4.13 |  |
|  |  |  |  |  |  |        3X         |        | 2021.4.13 |  |
|  |  |  |  |  |  |                   |        |           |  |
| ml-100k |  | IMC-GAE | 0.14 | 0.15 | 0.18 |        0X         | 0.8967 | 2021.4.8  |  |
|   ml-100k   |  | IMC-GAE |  0.17   |  0.19   |  0.24   |        1X         | 1.0062 | 2021.4.12 |  |
|   ml-100k   |  | IMC-GAE | 0.2107  | 0.2457  | 0.2995  |        2X         |  | 2021.4.12 |  |
|   ml-100k   |  | IMC-GAE | 0.1852  | 0.2170  | 0.2699  |        3X         | 1.1584 | 2021.4.12 |  |
|   ml-100k   |  | IMC-GAE | 0.1101  | 0.1219  | 0.1529  |        5X         | 1.5976 | 2021.4.12 |  |
|   ml-100k   |  | IMC-GAE | 0.0978  | 0.0997  | 0.1177  |        10X        | 1.6241 | 2021.4.12 |  |
|             |         |         |         |         |         |                   |  |  |  |
|   ml-100k   |  | IMC-GAE | 0.1720  | 0.1903  | 0.2285  |        1X         |  | 2021.4.19 | 随机负采样 |
|   ml-100k   |  | IMC-GAE | 0.1657  | 0.1813  | 0.2205  |        2X         |  | 2021.4.19 | 随机负采样 |
|   ml-100k   |  | IMC-GAE | 0.1690  | 0.1809  | 0.2198  |        3X         |  | 2021.4.19 | 随机负采样 |
|   ml-100k   |  | IMC-GAE | 0.1763  | 0.1916  | 0.2339  |        5X         |  | 2021.4.19 | 随机负采样 |
|   ml-100k   |  | IMC-GAE | 0.1795  | 0.1962  | 0.2387  |        10X        |  | 2021.4.19 | 随机负采样 |
|             |         |         |         |         |         |                   |  |  |  |
|   ml-100k   |    |  NeuMF  |  0.29   |  0.33   |  0.39   |         \         |  | 2021.4.8 |  |
|   ml-100k   |       |   MF    | 0.2699  | 0.3074  | 0.3645  |                   |  | 2021.4.13 |  |
|             |         |         |         |         |         |                   |  |  |  |
| Tmall_small | 2 | IMC-GAE | 0.2440  | 0.2869  | 0.3144  |        1X         | 0.2740 | 2021.4.12 |  |
| Tmall_small | 2 | IMC-GAE | 0.2512  | 0.4104  | 0.4555  |        2X         | 0.5695 | 2021.4.12 |            |
| Tmall_small | 2 | IMC-GAE | 0.3088  | 0.3682  | 0.4876  |        5X         | 0.6760 | 2021.4.12 |  |
| Tmall_small | 2 | IMC-GAE | 0.2898 | 0.3566 | 0.4388 | 10X | 0.8120 | 2021.4.12 |  |
| Tmall_small | 2 | IMC-GAE | 0.3163 | 0.3669 | 0.3950 | 100X | 0.8421 | 2021.4.12 |  |
| Tmall_small | 2 | IMC-GAE | 0.2484 | 0.2947 | 0.3475 | 150X | 0.8487 | 2021.4.12 |  |
|  |  |  |  |  |  |  |  |  |  |
|   ml-100k   |    |  NeuMF  |  0.29   |  0.33   |  0.39   |         \         |        | 2021.4.8  |  |
| Tmall_small |  | NeuMF | 0.0346 | 0.0370 | 0.0435 | \ |  | 2021.4.12 |  |
|    Tmall    |    |  NeuMF  | 0.0222  | 0.0311  | 0.0436  |         \         |        | 2021.4.12 |  |
|             |         |         |         |         |         |                   |        |  |  |
| ml-100k |  | MF | 0.2699  | 0.3074  | 0.3645  |                   |        | 2021.4.13 |            |
| Tmall_small |       |   MF    | 0.0433 | 0.0575 | 0.0714 |  |  | 2021.4.13 |  |
|    Tmall    |       |   MF    | 0.0323 | 0.0431 | 0.0564 |  |  | 2021.4.13 |  |
|             |         |         |         |         |         |                   |        |           |            |
| 训练数据 |  | 模型 | NDCG@20 | NDCG@40 | NDCG@80 | Negative sampling | RMSE | 训练时间 | best index |
|  |  |  |  |  |  |  |  |  |  |
| Tmall | 2 | IMC-GAE | 0.0019 | 0.0031 | 0.0031 | 0X |  | 2021.4.21 | 无采样 |
|  |  |  |  |  |  |  |  |  |  |
|    Tmall    | 2 | IMC-GAE | 0.0417  | 0.0488  | 0.0578  |        1X         |        | 2021.4.20 | 随机负采样 |
|    Tmall    | 2 | IMC-GAE | 0.0447  | 0.0553  | 0.0716  |        2X         |        | 2021.4.20 | 随机负采样 |
|    Tmall    | 2 | IMC-GAE | 0.0466 | 0.0555  | 0.0712  |        3X         |        | 2021.4.20 | 随机负采样 |
|   Tmalll   | 2 | IMC-GAE | 0.0039  | 0.0054  | 0.0083  |        5X         |        | 2021.4.20 | 随机负采样 |
| | | | | | | | | | |
| | | | | | | | | | |
| | | | | | | | | | |
| Tmall | 5 | IMC-GAE | 0.0469 | 0.0562 | 0.0694 | 1X | | 2021.4.21 | 单次负采样 |
| Tmall | 5 | IMC-GAE | 0.0465 | 0.0551 | 0.0717 | 2X | | 2021.4.21 | 单次负采样 |
| Tmall | 5 | IMC-GAE | 0.0463 | 0.0562 | 0.0717 | 3X | | 2021.4.21 | 单次负采样 |
| Tmall | 5 | IMC-GAE | 0.0469 | 0.0559 | 0.0719 | 5X | | 2021.4.21 | 单次负采样 |
| | | | | | | | | | |
| | | | | | | | | | |
| | | | | | | | | | |
| | | | | | | | | | |
|             |         |          |         |         |         |                   |            |           |            |
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |  |  |  |
| 训练数据 | dataset | 模型 | NDCG@20 | NDCG@40 | NDCG@80 | Negative sampling | best index | 训练时间 |  |
| Tmall | 2 | NGCF | 0.0324 | 0.0423 | 0.0554 |                   |        | 2021.4.20 |            |
| Tmall | 2 | NeuMF | 0.0344 | 0.0449 | 0.0578 |                   |        | 2021.4.20 |            |
| Tmall | 2 | LightGCN | 0.0613 | 0.0757 | 0.0926 | | | 2021.4.21 | |
|  |  |  |  |  |  | | |  | |
| Tmall | 3 | NGCF | 0.0196 | 0.0266 | 0.0345 | | | 2021.4.22 | |
| Tmall | 3 | NeuMF | 0.0135 | 0.0189 | 0.0263 | | | 2021.4.22 | |
| Tmall | 3 | LightGCN | 0.0438 | 0.0543 | 0.0661 | | | 2021.4.22 | |
|             |         |  |  |  |  | | |  | |
| Tmall | 4 | NGCF | 0.0123 | 0.0161 | 0.0204 | | | 2021.4.22 | |
| Tmall | 4 | NeuMF | 0.0098 | 0.0131 | 0.0175 | | | 2021.4.22 | |
| Tmall | 4 | LightGCN | 0.0276 | 0.0329 | 0.0383 | | | 2021.4.22 | |
|  |  |  |  |  |  | | |  | |
| Tmall | 2 | IMC-GAE | 0.0151 | 0.0183 | 0.0223 | 3X | 120 | 2021.4.22 | 随机采样 |
| Tmall | 3 | IMC-GAE | 0.0387 | 0.0507 | 0.0650 | 3X | 2 | 2021.4.22 | 随机采样 |
|    Tmall    | 4       | IMC-GAE  | 0.0022 | 0.0065 | 0.0138 | 3X | 19 | 2021.4.22 | 随机采样 |
|             |         |          |  |  |  |  |  |  |  |
|    Tmall    | 2       | IMC-GAE  | 0.0440  | 0.0549  | 0.0719  | 3X |  | 2021.4.22 | 单次采样 |
|    Tmall    | 3       | IMC-GAE  | 0.0375  | 0.0485  | 0.0635  | 3X |  | 2021.4.22 | 单次采样 |
|    Tmall    | 4       | IMC-GAE  | 0.0312  | 0.0405  | 0.0498  | 3X |  | 2021.4.22 | 单次采样 |
|             |         |          |  |  |  |  |  |  |  |
|             |         |          |  |  |  |  |  |  |  |

## 抽取方法

数据集1. 原数据集：

```
总体数目: 100150806
item数目: 4162024
user数目: 987994
click:0.002182 %
fav:0.000070 %
cart:0.000134 %
buy:0.000049 %
```
数据集2. Tmall_40_4000_40_4000

选取item的被购买次数大于40，user购买次数大于40的数据。

其中各种行为占比为：

```
总体数目: 211390
item数目: 3947
user数目: 4000
click:1.166912 %
fav:0.034191 %
cart:0.087294 %
buy:0.050532 %
```

数据集3. Tmall_20_4000_20_4000

选取item的被购买次数大于在20的item，从中随机抽取4000种item作为研究对象

选取user中购买次数大于20的user，从中随机抽取4000个人作为样本

```
总体数目: 109460
item数目: 3841
user数目: 4000
click:0.619018 %
fav:0.019266 %
cart:0.048002 %
buy:0.026159 %
```

数据集4：Tmall_0_4000_20_4000


选取item的被购买次数大于在20的item，从中随机抽取4000种item作为研究对象

选取user中购买次数大于0的user，从中随机抽取4000个人作为样本

```
总体数目: 21798
item数目: 3350
user数目: 4000
click:0.139254 %
fav:0.004306 %
cart:0.012246 %
buy:0.006866 %
```

数据集5：Tmall dataset in MB paper

```
总体数目: 2292594
item数目: 11953
user数目: 41738
sparsity: 0.4595 %
click:0.3635 %
fav:0.0444 %
cart:0.0004 %
buy:0.0512 %
```



| 训练数据 |  模型   | NDCG@20 | NDCG@40 | NDCG@80 | Negative sampling | RMSE   | 训练时间  | best index | dataset |
| :------: | :-----: | :-----: | :-----: | :-----: | :---------------: | ------ | --------- | ---------- | ------- |
|  Tmall   | IMC-GAE | 0.0022  | 0.0065  | 0.0138  |        3X         | 0.7417 | 2021.4.21 | 19         | 4       |
|  Tmall   | IMC-GAE |         |         |         |        5X         |        | 2021.4.21 |            |         |
|  Tmall   | IMC-GAE |         |         |         |        2X         |        | 2021.4.21 |            |         |
|  Tmall   | IMC-GAE |         |         |         |        3X         |        | 2021.4.21 |            |         |
|          |         |         |         |         |                   |        |           |            |         |
|          |         |         |         |         |                   |        |           |            |         |


```
python -u train.py --data_name=ml-100k \
                       --use_one_hot_fea \
                       --device 0 \
                       --ARR 0.00004 \
                       --layers 2 \
                       --data_valid_ratio 0.05 \
                       --model_activation tanh 
```

```
python -u train.py --data_name=Tmall_0_4000_20_4000 \
                       --use_one_hot_fea \
                       --gcn_agg_accum=sum \
                       --device 0 \
                       --ARR 0.00000000000 \
                       --train_early_stopping_patience 100 \
                       --layers 2 \
                       --gcn_agg_units 30 \
                       --train_lr 0.01 \
                       --data_valid_ratio 0.1 \
                       --model_activation tanh \
                       --gcn_out_units 30
```

```
python -u train.py --data_name=Tmall \
                       --use_one_hot_fea \
                       --gcn_agg_accum=sum \
                       --device 0 \
                       --ARR 0.00000000000 \
                       --train_early_stopping_patience 200 \
                       --layers 2 \
                       --gcn_agg_units 30 \
                       --train_lr 0.01 \
                       --data_valid_ratio 0.1 \
                       --model_activation tanh \
                       --gcn_out_units 30
```



```
python NeuMF.py --dataset ml-1m --epochs 20 --batch_size 256 --num_factors 8 --layers '[64,32,16,8]' --reg_mf 0 --reg_layers '[0,0,0,0]' --num_neg 4 --lr 0.001 --learner adam --verbose 1 --out 1
```

```
python -u test.py --data_name=ml-100k \
                       --use_one_hot_fea \
                       --device 0 \
                       --ARR 0.00004 \
                       --layers 2 \
                       --data_valid_ratio 0.05 \
                       --model_activation tanh 
```

